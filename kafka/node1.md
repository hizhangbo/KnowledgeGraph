- Kafka架构
  - 优势
    - 程序设计
      - 基于Zookeeper，集群较为简单
      - replic 副本高可用
      - broker 采用tcp协议传输
      - topic 主题分类消息
      - partition 分区提高并发，数量应该和CPU核数相同
      - consumer 消费者数量应该和partition数量相同
    - CPU
      - partition并发
    - 内存
      - MMAP（Memory Mapped Files）内存映射文件
        - 文件系统+页缓存：利用操作系统的页缓存来实现文件到物理内存的直接映射
        - 使用物理内存后，不再依赖JVM，kafka重启后数据依然可以使用
        - kafka写入持久化日志中不是刷新到磁盘，而是转移到内核空间的页缓存中
      - 零拷贝
        - 用户态-内核态 transferTo 读取省略从内核态往用户态拷贝的过程，写入省略用户态往内核态拷贝的过程
    - 磁盘
      - 数据写入，采用顺序写入
      - 消息消费完成后，不会立刻删除，默认保留7天
      - offset
        - 可能会重复读
        - 可能会丢失数据
    - 网络传输
      - 批量压缩